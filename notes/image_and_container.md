# Notes > イメージとコンテナ

## イメージ/コンテナとは?

### イメージとは

- 例えるなら: レシピ
  - 「レシピ」なので「材料」を追加できる&共有できる

### コンテナとは

- 例えるなら: レシピから作られた料理
  - 料理なので, 後からトッピングしたり材料を取り除いたりする等アレンジできるが共有はできない
  - 共有したいときはレシピの方を共有する
  - アレンジした料理を共有したいときは, 新たなレシピとして書き起こしそれを共有する

## キラー

- 環境の使い分けが可能&容易になる
  - 文字PV用, 茶番用, 実験用という風に分けられる
  - トリミングなどの軽めの編集だけなら, 動作が軽い, 最低限のプラグインしか入っていないイメージ/コンテナを使用する

- 配布しやすい
  - イメージファイルを共有してそれを読み込んでもらえば, ほぼ同じ環境が再現できる

## イメージの機能

### プラグイン管理

ファイルのダウンロードは行われない。

- 追加
  - 対象プラグイン情報を`image.azanautl.yaml`に追加
- 削除
  - 対象プラグイン情報を`image.azanautl.yaml`から削除

## コンテナの機能

### プラグイン管理_

`インストール`ではファイルのダウンロードが行われる。

- インストール
  - 対象プラグインのファイルをダウンロードして`plugins`ディレクトリに移動
  - 対象プラグイン情報を`container.azanautl.yaml`の`enabled`フィールドに追加
- アンインストール
  - `plugins`ディレクトリ内のファイルを削除
  - 対象プラグイン情報を`container.azanautl.yaml`の`enabled`フィールドまたは`disabled`フィールドから削除
- 無効にする
  - remove, 対象プラグインを一時的に`trash`ディレクトリに移動
  - 対象プラグイン情報を`container.azanautl.yaml`の`enabled`フィールドから`disabled`フィールドに移動
- 有効にする
  - un-remove, 対象プラグインを`trash`ディレクトリから復活
  - 対象プラグイン情報を`container.azanautl.yaml`の`disabled`フィールドから`enabled`フィールドに移動

## プラグイン・スクリプトのダウンロード・インストール

### コマンド_

`$ azanac container "container_1" plugins get "hoge:1.2.0"`

### 処理内容

1. `packages.yaml`が改竄されていないか電子署名？で検証する
1. `cache`ディレクトリにファイルが存在する場合, ファイルを`temp`ディレクトリにコピーした後`7.`から始める
1. デフォルトブラウザで配布サイトのURLを開く (`start URL`と実行する)
1. エクスプローラーで`temp`ディレクトリを開く
1. ユーザーが, ブラウザ上で配布サイトからファイルをダウンロードする
1. ユーザーが, ダウンロードしたファイルを`temp`ディレクトリに移動もしくはコピーする
1. `temp`ディレクトリ内のファイルのハッシュ値を計算し, ハッシュ値が一致するか確認する
1. ファイルを解凍し, コンテナの`plugins`もしくは`scripts`ディレクトリに移動する
1. キャッシュするオプションが有効かつ`cache`ディレクトリにファイルが存在しない場合, ファイルを`cache`ディレクトリにコピーする
